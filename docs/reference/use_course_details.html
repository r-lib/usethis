<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Download and unpack a ZIP file — use_course_details • usethis</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Download and unpack a ZIP file — use_course_details" />
<meta property="og:description" content="Details on the two functions that power use_course(). These internal
functions are currently unexported but a course instructor may want more
details." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">usethis</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/articles/usethis-setup.html">Setup</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Blog posts</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2017/11/usethis-1.0.0/">usethis 1.0.0 (and 1.1.0)</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/02/usethis-1-3-0/">usethis 1.3.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-lib/usethis">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Download and unpack a ZIP file</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-lib/usethis/blob/master/R/course.R'><code>R/course.R</code></a></small>
    <div class="hidden name"><code>use_course_details.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Details on the two functions that power <code><a href='use_course.html'>use_course()</a></code>. These internal
functions are currently unexported but a course instructor may want more
details.</p>
    </div>


    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>url</th>
      <td><p>Download link for the ZIP file, possibly behind a shortlink or
other redirect. See Details.</p></td>
    </tr>
    <tr>
      <th>destdir</th>
      <td><p>Path to existing local directory where the ZIP file will be
stored. Defaults to current working directory, but note that <code><a href='use_course.html'>use_course()</a></code>
has different default behavior.</p></td>
    </tr>
    <tr>
      <th>pedantic</th>
      <td><p>Logical. When <code>TRUE</code> and in an interactive session, the user
is told where the ZIP file will be stored. If happy, user can elect to
proceed. Otherwise, user can abort and try again with the desired
<code>destdir</code>. Intentional friction for a pedagogical setting.</p></td>
    </tr>
    <tr>
      <th>zipfile</th>
      <td><p>Path to local ZIP file.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="download-zip-"><a class="anchor" href="#download-zip-"></a>download_zip()</h2>

    <pre>## function signature
download_zip(url, destdir = getwd(), pedantic = FALSE)
    ## as called inside use_course()
download_zip(
  url, ## after post-processing with normalize_url()
  ## conspicuous_place() = Desktop or home directory or working directory
  destdir = destdir \%||\% conspicuous_place(),
  pedantic = is.null(destdir) &amp;&amp; interactive()
)
</pre>
    <p>Special-purpose function to download a ZIP file and automatically determine
the file name, which often determines the folder name after unpacking.
Developed with DropBox and GitHub as primary targets, possibly via
shortlinks. Both platforms offer a way to download an entire folder or repo
as a ZIP file, with information about the original folder or repo transmitted
in the <code>Content-Disposition</code> header. In the absence of this header, a
filename is generated from the input URL. In either case, the filename is
sanitized. Returns the path to downloaded ZIP file, invisibly.</p>
<p><strong>DropBox:</strong></p>
<p>To make a folder available for ZIP download, create a shared link for it:</p><ul>
<li><p><a href='https://www.dropbox.com/help/files-folders/view-only-access'>https://www.dropbox.com/help/files-folders/view-only-access</a></p></li>
</ul>
    <p>A shared link will have this form:</p><pre>https://www.dropbox.com/sh/12345abcde/6789wxyz?dl=0
</pre>
    <p>Replace the <code>dl=0</code> at the end with <code>dl=1</code> to create a download link. The ZIP
download link will have this form:</p><pre>https://www.dropbox.com/sh/12345abcde/6789wxyz?dl=1
</pre>
    <p>This download link (or a shortlink that points to it) is suitable as input
for <code>download_zip()</code>. After one or more redirections, this link will
eventually lead to a download URL. For more details, see
<a href='https://www.dropbox.com/help/desktop-web/force-download'>https://www.dropbox.com/help/desktop-web/force-download</a> and
<a href='https://www.dropbox.com/en/help/desktop-web/download-entire-folders'>https://www.dropbox.com/en/help/desktop-web/download-entire-folders</a>.</p>
<p><strong>GitHub:</strong></p>
<p>Click on the repo's "Clone or download" button, to reveal a "Download ZIP"
button. Capture this URL, which will have this form:</p><pre>https://github.com/r-lib/usethis/archive/master.zip
</pre>
    <p>This download link (or a shortlink that points to it) is suitable as input
for <code>download_zip()</code>. After one or more redirections, this link will
eventually lead to a download URL. Here's an alternative link that also leads
to ZIP download, albeit with a different filenaming scheme:</p><pre>https://api.github.com/repos/r-lib/usethis/zipball/master
</pre>
    <h2 class="hasAnchor" id="tidy-unzip-"><a class="anchor" href="#tidy-unzip-"></a>tidy_unzip()</h2>

    
    <p>Special-purpose function to unpack a ZIP file and (attempt to) create the
directory structure most people want. When unpacking an archive, it is easy
to get one more or one less level of nesting than you expected.</p>
<p>It's especially important to finesse the directory structure here: we want
the same local result when unzipping the same content from either GitHub or
DropBox ZIP files, which pack things differently. Here is the intent:</p><ul>
<li><p>If the ZIP archive <code>foo.zip</code> does not contain a single top-level directory,
i.e. it is packed as "loose parts", unzip into a directory named <code>foo</code>.
Typical of DropBox ZIP files.</p></li>
<li><p>If the ZIP archive <code>foo.zip</code> has a single top-level directory (which, by
the way, is not necessarily called "foo"), unpack into said directory.
Typical of GitHub ZIP files.</p></li>
</ul>
    <p>Returns path to the directory holding the unpacked files, invisibly.</p>
<p><strong>DropBox:</strong>
The ZIP files produced by DropBox are special. The file list tends to contain
a spurious directory <code>"/"</code>, which we ignore during unzip. Also, if the
directory is a Git repo and/or RStudio Project, we unzip-ignore various
hidden files, such as <code>.RData</code>, <code>.Rhistory</code>, and those below <code>.git/</code> and
<code>.Rproj.user</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other download functions: <code><a href='use_course.html'>use_course</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'>download_zip</span>(<span class='st'>"https://github.com/r-lib/rematch2/archive/master.zip"</span>)
<span class='co'># }</span><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='fu'>download_zip</span>(<span class='st'>"https://github.com/r-lib/rematch2/archive/master.zip"</span>)
<span class='fu'>tidy_unzip</span>(<span class='st'>"rematch2-master.zip"</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#download-zip-">download_zip()</a></li>
      <li><a href="#tidy-unzip-">tidy_unzip()</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://hadley.nz'>Hadley Wickham</a>, Jennifer Bryan, <a href='https://www.rstudio.com'><img src='https://tidyverse.org/rstudio-logo.svg' alt='RStudio' height='24' /></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

