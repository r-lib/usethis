<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Managing Git(Hub) Credentials • usethis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Managing Git(Hub) Credentials">
<meta name="robots" content="noindex">
<script defer data-domain="usethis.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">usethis</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/usethis-setup.html">Setup</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/usethis-setup.html">usethis setup</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Git and GitHub</h6></li>
    <li><a class="dropdown-item" href="../articles/git-credentials.html">Managing Git(Hub) Credentials</a></li>
    <li><a class="dropdown-item" href="../articles/pr-functions.html">Pull request helpers</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/10/renaming-default-branch/">Renaming the default branch (usethis &gt;= 2.1.2)</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/12/usethis-2-0-0/">usethis 2.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/04/usethis-1-6-0/">usethis 1.6.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2019/04/usethis-1.5.0/">usethis 1.5.0 (and 1.4.0)</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2018/02/usethis-1-3-0/">usethis 1.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2017/11/usethis-1.0.0/">usethis 1.0.0 (and 1.1.0)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/usethis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Managing Git(Hub) Credentials</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/usethis/blob/main/vignettes/articles/git-credentials.Rmd" class="external-link"><code>vignettes/articles/git-credentials.Rmd</code></a></small>
      <div class="d-none name"><code>git-credentials.Rmd</code></div>
    </div>

    
    
<!-- This vignette uses a convention of "one sentence per line" in prose. -->
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usethis.r-lib.org">usethis</a></span><span class="op">)</span></span></code></pre></div>
<p>usethis can help you with many of the Git and GitHub tasks that arise
when managing R projects and packages. Under the hood, two lower-level
packages are critical to this:</p>
<ul>
<li>gert, for Git operations, like <code>git init</code>,
<code>git commit</code>, and <code>git push</code> (<a href="https://docs.ropensci.org/gert/" class="external-link">docs.ropensci.org/gert</a>)</li>
<li>gh, for GitHub API operations, like creating a repo, forking a repo,
and opening a pull request (<a href="https://gh.r-lib.org/" class="external-link">gh.r-lib.org</a>)</li>
</ul>
<p>Both packages need access to credentials in order to act on your
behalf:</p>
<ul>
<li>gert interacts with GitHub as a Git server, using either the HTTPS
or SSH protocol</li>
<li>gh interacts with GitHub via its REST API</li>
</ul>
<p>This article describes our recommendations for how to set up your Git
and GitHub credentials. Our goal is a setup that works well for usethis
<strong>and</strong> for other tools you may be using, such as command
line Git and Git clients (including, but not limited to, RStudio).</p>
<p><em>This is a good time to check that you have up-to-date versions of
the packages we’re talking about here. In particular, you want gh &gt;=
v1.2.1, which knows about the new token format GitHub announced and
adopted in March 2021.</em></p>
<div class="section level2">
<h2 id="tldr-use-https-2fa-and-a-github-personal-access-token">TL;DR: Use HTTPS, 2FA, and a GitHub Personal Access Token<a class="anchor" aria-label="anchor" href="#tldr-use-https-2fa-and-a-github-personal-access-token"></a>
</h2>
<p>Our main recommendations are:</p>
<ol style="list-style-type: decimal">
<li>Adopt HTTPS as your Git transport protocol.</li>
<li>Turn on two-factor authentication for your GitHub account.</li>
<li>Use a personal access token (PAT) for all Git remote operations from
the command line or from R.</li>
<li>Allow tools to store and retrieve your credentials from the Git
credential store. If you have previously set your GitHub PAT in
<code>.Renviron</code>, <strong>stop doing that</strong>.</li>
</ol>
<p>Next we provide some context and a rationale for these
recommendations. In the following section, we explain how to actually
implement this.</p>
<div class="section level3">
<h3 id="https-vs-ssh">HTTPS vs SSH<a class="anchor" aria-label="anchor" href="#https-vs-ssh"></a>
</h3>
<p>Instead of HTTPS, you could use SSH. Many people have valid reasons
for preferring SSH and they should carry on. Our recommendation for
HTTPS is because it’s easier than SSH for newcomers to set up correctly,
especially on Windows. GitHub has also long recommended HTTPS to new
users. Finally, using HTTPS with a PAT kills two birds with one stone:
this single credential can be used to authenticate to GitHub as a
regular Git server and for its REST API. If you authenticate via SSH for
“regular” Git work, you still have to set up a PAT for work that uses
the REST API.</p>
<p><img src="img%2Fpat-kills-both-birds.jpeg" alt="Diagram showing different ways of interacting with GitHub as a server and the credential needed for each method" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="two-factor-authentication">Two-factor authentication<a class="anchor" aria-label="anchor" href="#two-factor-authentication"></a>
</h3>
<p>Turning on two-factor authentication for important online accounts is
just a good idea, in general. For example, we make 2FA a hard
requirement for all members of the tidyverse and r-lib GitHub
organizations.</p>
<p>In the past, activating 2FA also forced those using HTTPS to use a
PAT, instead of “username + password”, for operations like
<code>git push</code>. Using a PAT is now an absolute requirement, for
all operations using the HTTPS protocol, and no longer has anything to
do with 2FA.</p>
<p>More background on the deprecation of “username + password” can be
found in GitHub’s blog post <a href="https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/" class="external-link">Token
authentication requirements for Git operations</a>.</p>
</div>
<div class="section level3">
<h3 id="git-credential-helpers-and-the-credential-store">Git credential helpers and the credential store<a class="anchor" aria-label="anchor" href="#git-credential-helpers-and-the-credential-store"></a>
</h3>
<p>It’s awkward to provide your credentials for every single Git
transaction, so it’s customary to let your system remember your
credentials. Git uses so-called credential helpers for this and,
happily, they tend to “just work” these days (especially, on macOS and
Windows) <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;If you’re trying to follow the advice in this article
and things don’t work the way we say they do, consider that you may need
to update Git. Credential helpers are absolutely an area of Git that has
improved rapidly in recent years and the gitcreds and credentials
package work best with recent versions of Git.&lt;/p&gt;"><sup>1</sup></a>. Git credential helpers take advantage of
official OS-provided credential stores, where possible, such as macOS
Keychain and Windows Credential Manager.</p>
<p>Recent innovations in gert and gh mean that Git/GitHub operations
from R can also store and discover credentials using these same official
Git credential helpers. This means we can stop storing GitHub PATs in
plain text in a startup file, like <code>.Renviron</code> <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;An even more dangerous practice is to hard-code a PAT in
an R script, which is never a good idea.&lt;/p&gt;"><sup>2</sup></a>. This, in turn,
reduces the risk of accidentally leaking your credentials.</p>
</div>
</div>
<div class="section level2">
<h2 id="practical-instructions">Practical instructions<a class="anchor" aria-label="anchor" href="#practical-instructions"></a>
</h2>
<p>How do you actually implement these recommendations? The diagnostic
functions <code><a href="../reference/github-token.html">usethis::gh_token_help()</a></code> and
<code><a href="../reference/git_sitrep.html">usethis::git_sitrep()</a></code> will offer some of the advice you see
here, but directly in your R session.</p>
<div class="section level3">
<h3 id="adopt-https">Adopt HTTPS<a class="anchor" aria-label="anchor" href="#adopt-https"></a>
</h3>
<p>Make sure to use HTTPS URLs, not SSH, when cloning repos or adding
new remotes:</p>
<ul>
<li>HTTPS URLs look like this:
<code>https://github.com/&lt;OWNER&gt;/&lt;REPO&gt;.git</code>
</li>
<li>SSH URLs look like this:
<code>git@github.com:&lt;OWNER&gt;/&lt;REPO&gt;.git</code>
</li>
</ul>
<p>usethis defaults to HTTPS in functions like
<code><a href="../reference/create_from_github.html">create_from_github()</a></code> and <code><a href="../reference/use_github.html">use_github()</a></code>, as of
v2.0.0<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;As always, the &lt;code&gt;usethis.protocol&lt;/code&gt; option can
be configured to customize your own default.&lt;/p&gt;"><sup>3</sup></a>.</p>
<p>It’s fine to adopt HTTPS for new work, even if some of your
pre-existing repos use SSH.<br>
It’s fine to use HTTPS for one remote in a repo and SSH for
another.<br>
It’s fine to use HTTPS remotes for one repo and SSH remotes for
another.<br>
It’s fine to interact with a GitHub repo via HTTPS from one computer and
via SSH from another.<br>
This is not an all-or-nothing or irreversible decision.<br>
As long as the relevant tools can obtain the necessary credentials from
a cache or you, you are good to go.</p>
</div>
<div class="section level3">
<h3 id="turn-on-two-factor-authentication">Turn on two-factor authentication<a class="anchor" aria-label="anchor" href="#turn-on-two-factor-authentication"></a>
</h3>
<p>See GitHub’s most current instructions here:</p>
<p><a href="https://docs.github.com/en/authentication/securing-your-account-with-two-factor-authentication-2fa" class="external-link">Securing
your account with two-factor authentication (2FA)</a></p>
<p>If you don’t already use a password manager such as 1Password or
Bitwarden, this is a great time to start! Among other benefits, these
apps can serve as an authenticator for 2FA.</p>
<p>Turning on 2FA is recommended, but optional.</p>
</div>
<div class="section level3">
<h3 id="get-a-personal-access-token-pat">Get a personal access token (PAT)<a class="anchor" aria-label="anchor" href="#get-a-personal-access-token-pat"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="../reference/github-token.html">create_github_token</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Assuming you’re signed into GitHub,
<code><a href="../reference/github-token.html">create_github_token()</a></code> takes you to a pre-filled form to
create a new PAT. You can get to the same page in the browser by
clicking on “Generate new token” from <a href="https://github.com/settings/tokens" class="external-link uri">https://github.com/settings/tokens</a>. The advantage of
<code><a href="../reference/github-token.html">create_github_token()</a></code> is that we have pre-selected some
recommended scopes, which you can look over and adjust before clicking
“Generate token”.</p>
<p><img src="img%2Fnew-personal-access-token-screenshot.png" alt="Screenshot: Getting a new personal access token on GitHub" width="80%" style="display: block; margin: auto;"></p>
<p>It is a very good idea to describe the token’s purpose in the
<em>Note</em> field, because one day you might have multiple PATs. We
recommend naming each token after its use case, such as the computer or
project you are using it for, e.g. “personal-macbook-air” or
“vm-for-project-xyz”. In the future, you will find yourself staring at
this list of tokens, because inevitably you’ll need to re-generate or
delete one of them. Make it easy to figure out which token you need to
fiddle with.</p>
<p>GitHub encourages the use of perishable tokens, with a default
<em>Expiration</em> period of 30 days. Unless you have a specific reason
to fight this, I recommend accepting this default. I assume that
GitHub’s security folks have good reasons for their recommendation. But,
of course, you can adjust the <em>Expiration</em> behaviour as you see
fit, including “No expiration”.</p>
<p>Once you’re happy with the token’s <em>Note</em>,
<em>Expiration</em>, and <em>Scopes</em>, click “Generate token”.</p>
<p>You won’t be able to see this token again, so don’t close or navigate
away from this browser window until you store the PAT locally. Copy the
PAT to the clipboard, anticipating what we’ll do next: trigger a prompt
that lets us store the PAT in the Git credential store.</p>
<p>Sidebar about storing your PAT: If you use a password management app,
such as 1Password or Bitwarden (highly recommended!), you might want to
add this PAT (and its <em>Note</em>) to the entry for GitHub. Storing
your PAT in the Git credential store is a semi-persistent convenience,
sort of like a browser cache or “remember me” on a website, but it’s
quite possible you will need to re-enter your PAT in the future. You
could decide to embrace the impermanence of your PAT and, if it is
somehow removed from the store, you’ll just re-generate a new PAT and
re-enter it. If you accept the default 30-day expiration period, this is
a workflow you’ll be using often anyway. But if you create long-lasting
tokens or want to play around with the functions for setting or clearing
your Git credentials, it can be handy to have your own record of your
PAT in a secure place, like 1Password or Bitwarden.</p>
</div>
<div class="section level3">
<h3 id="put-your-pat-into-the-local-git-credential-store">Put your PAT into the local Git credential store<a class="anchor" aria-label="anchor" href="#put-your-pat-into-the-local-git-credential-store"></a>
</h3>
<p>We assume you’ve created a PAT and have it available on your
clipboard.</p>
<p>How to insert your PAT in the Git credential store? Do this in R:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gitcreds</span><span class="fu">::</span><span class="fu"><a href="https://gitcreds.r-lib.org/reference/gitcreds_get.html" class="external-link">gitcreds_set</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You will have the <a href="https://r-lib.github.io/gitcreds/" class="external-link">gitcreds package</a> installed,
as of usethis v2.0.0, because usethis uses gh, and gh uses gitcreds.</p>
<p>If you don’t have a PAT stored already, it will prompt you to enter
your PAT. Paste!</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="op">&gt;</span> gitcreds::gitcreds_set<span class="kw">()</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="ex">?</span> Enter password or token: ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="ex">-</span><span class="op">&gt;</span> Adding new credentials...</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="ex">-</span><span class="op">&gt;</span> Removing credentials from cache...</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="ex">-</span><span class="op">&gt;</span> Done.</span></code></pre></div>
<p>If you already have a stored credential,
<code><a href="https://gitcreds.r-lib.org/reference/gitcreds_get.html" class="external-link">gitcreds::gitcreds_set()</a></code> reveals this and will even let you
inspect it. This helps you decide whether to keep the existing
credential or replace it. When in doubt, embrace a new, known-to-be-good
credential over an old one, of uncertain origins.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="op">&gt;</span> gitcreds::gitcreds_set<span class="kw">()</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="ex">-</span><span class="op">&gt;</span> Your current credentials for <span class="st">'https://github.com'</span>:</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="ex">protocol:</span> https</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="ex">host</span>    : github.com</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="ex">username:</span> PersonalAccessToken</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="ex">password:</span> <span class="op">&lt;</span>-- hidden <span class="at">--</span><span class="op">&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="ex">-</span><span class="op">&gt;</span> What would you like to do<span class="pp">?</span> </span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="ex">1:</span> Keep these credentials</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="ex">2:</span> Replace these credentials</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="ex">3:</span> See the password / token</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="ex">Selection:</span> 2</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="ex">-</span><span class="op">&gt;</span> Removing current credentials...</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="ex">?</span> Enter new password or token: ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="ex">-</span><span class="op">&gt;</span> Adding new credentials...</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="ex">-</span><span class="op">&gt;</span> Removing credentials from cache...</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="ex">-</span><span class="op">&gt;</span> Done.</span></code></pre></div>
<p><strong>If you have previously made your GitHub PAT available by
setting the <code>GITHUB_PAT</code> environment variable in
<code>.Renviron</code>, you need to actively stop doing that!</strong>
If you have any doubt about your previous practices, open
<code>.Renviron</code>, look for any line setting the
<code>GITHUB_PAT</code> or <code>GITHUB_TOKEN</code> environment
variable, and delete that line. <code><a href="../reference/edit.html">usethis::edit_r_environ()</a></code>
can be helpful for getting <code>.Renviron</code> open for editing.
Don’t forget to restart R for this change to take effect!</p>
<p>You can check that your PAT has been successfully stored with
<code><a href="../reference/github-token.html">usethis::gh_token_help()</a></code> <strong>executed in a fresh R
session</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/github-token.html">gh_token_help</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The more general function <code><a href="../reference/git_sitrep.html">usethis::git_sitrep()</a></code> will
also report on your PAT, along with other aspects of your Git/GitHub
setup.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/git_sitrep.html">git_sitrep</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ongoing-pat-maintenance">Ongoing PAT maintenance<a class="anchor" aria-label="anchor" href="#ongoing-pat-maintenance"></a>
</h3>
<p>You are going to be (re-)generating and (re-)storing your PAT on a
schedule dictated by its expiration period. By default, once per
month.</p>
<p>When the PAT expires, return to <a href="https://github.com/settings/tokens" class="external-link uri">https://github.com/settings/tokens</a> and click on its
<em>Note</em>. (You do label your tokens nicely by use case, right?
Right?) At this point, you can optionally adjust scopes and then click
“Regenerate token”. You can optionally modify its <em>Expiration</em>
and then click “Regenerate token” (again). As before, copy the PAT to
the clipboard, call <code><a href="https://gitcreds.r-lib.org/reference/gitcreds_get.html" class="external-link">gitcreds::gitcreds_set()</a></code>, and
paste!</p>
<p>Hopefully it’s becoming clear why each token’s <em>Note</em> is so
important. The actual token may be changing, e.g., once a month, but its
use case (and scopes) are much more persistent and stable.</p>
<p>Sidebar: the gitcreds package plays the same role for gh as the <a href="https://docs.ropensci.org/credentials/" class="external-link">credentials package</a>
does for gert. Both gitcreds and credentials provide an R interface to
the Git credential store, but are targeting slightly different use
cases. The gitcreds and credentials packages are evolving convergently
and may, in fact, merge into one. But in the meantime, there is some
chance that they use a different “key”, in the “key-value” sense, when
storing or retrieving your PAT. Therefore, it is conceivable that
gert+credentials may also prompt you once for your PAT, in which case
you should just provide it again. To explicitly check if
gert+credentials can discover your PAT, call
<code><a href="https://docs.ropensci.org/credentials/reference/set_github_pat.html" class="external-link">credentials::set_github_pat()</a></code>. If it cannot, this will lead
to a prompt where you can enter it.</p>
</div>
</div>
<div class="section level2">
<h2 id="additional-resources">Additional resources<a class="anchor" aria-label="anchor" href="#additional-resources"></a>
</h2>
<p>Most users should be ready to work with Git and GitHub from R now,
specifically with gert, gh, and usethis. In this section, we cover more
specialized topics that only apply to certain users.</p>
<div class="section level3">
<h3 id="github-enterprise">GitHub Enterprise<a class="anchor" aria-label="anchor" href="#github-enterprise"></a>
</h3>
<p>As of v2.0.0, usethis should fully support GitHub Enterprise
deployments. If you find this is not true, please <a href="https://github.com/r-lib/usethis/issues/new" class="external-link">open an
issue</a>.</p>
<p>There are a few usethis functions that support an explicit
<code>host</code> argument, but in general, usethis honors the GitHub
host implicit in URLs, e.g., the locally configured Git remotes, or
inherits the default behaviour of gh. The gh package honors the
<code>GITHUB_API_URL</code> environment variable which, when unset,
falls back to <code>https://api.github.com</code>.</p>
<p>In general, usethis, gh, and gitcreds should all work with GitHub
Enterprise, as long as the intended GitHub host is discoverable or
specified. For example, you can store a PAT for a GitHub Enterprise
deployment like so:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gitcreds</span><span class="fu">::</span><span class="fu"><a href="https://gitcreds.r-lib.org/reference/gitcreds_get.html" class="external-link">gitcreds_set</a></span><span class="op">(</span><span class="st">"https://github.acme.com"</span><span class="op">)</span></span></code></pre></div>
<p>You can also troubleshoot PATs with GHE with the usual functions:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="../reference/github-token.html">gh_token_help</a></span><span class="op">(</span><span class="st">"https://github.acme.com"</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="../reference/git_sitrep.html">git_sitrep</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>At the time of writing, <code><a href="https://docs.ropensci.org/credentials/reference/set_github_pat.html" class="external-link">credentials::set_github_pat()</a></code> is
hard-wired to “github.com”, but this may be generalized in the
future.</p>
</div>
<div class="section level3">
<h3 id="what-about--renviron">What about <code>.Renviron</code>?<a class="anchor" aria-label="anchor" href="#what-about--renviron"></a>
</h3>
<p>In the past, the most common way to make a GitHub PAT available in R
was to define it as the <code>GITHUB_PAT</code> environment variable in
the <code>.Renviron</code> startup file. This still works, since
gitcreds+gh and credentials+gert check environment variables before they
consult the Git credential store. However, this also means that the
presence of a legacy <code>GITHUB_PAT</code> in your
<code>.Renviron</code> can get in the way of your adoption of the new
approach!</p>
<p>If you have any doubt about your previous practices, open
<code>.Renviron</code>, look for any line setting the
<code>GITHUB_PAT</code> environment variable, and delete it.
<code><a href="../reference/edit.html">usethis::edit_r_environ()</a></code> can be helpful for getting
<code>.Renviron</code> open for editing. Don’t forget to restart R for
this change to take effect.</p>
<p>Why do gitcreds+gh and credentials+gert even check environment
variables? Once they retrieve a PAT from the store, they temporarily
cache it in an environment variable, which persists for the duration of
the current R session. This allows a discovered PAT to be reused,
potentially by multiple packages, repeatedly over the course of an R
session.</p>
<p>Using <code>.Renviron</code> as your primary PAT store is less secure
and, if you can, it is safer to keep your PAT in the Git credential
store and let packages that need it to discover it there upon first
need. Linux users may still need to use the <code>.Renviron</code>
method, since they don’t have easy access to OS-managed stores like the
macOS Keychain or Windows Credential Manager.</p>
<p>If you still need to use <code>.Renviron</code> method,
<code><a href="../reference/edit.html">usethis::edit_r_environ()</a></code> opens that file for editing.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="../reference/edit.html">edit_r_environ</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Add a line like this, <strong>but substitute your PAT</strong>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="va">GITHUB_PAT</span><span class="op">=</span>ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></code></pre></div>
<p>Make sure this file ends in a newline! Lack of a newline can lead to
silent failure to load startup files, which can be tricky to debug. Take
care that this file is not accidentally pushed to the cloud, e.g. Google
Drive or GitHub.</p>
<p>Restart R for changes in <code>.Renviron</code> to take effect.</p>
</div>
<div class="section level3">
<h3 id="what-about-the-remotes-and-pak-packages">What about the remotes and pak packages?<a class="anchor" aria-label="anchor" href="#what-about-the-remotes-and-pak-packages"></a>
</h3>
<p>The <a href="https://remotes.r-lib.org" class="external-link">remotes</a> and <a href="https://pak.r-lib.org" class="external-link">pak</a> packages both help us to install R
packages from GitHub:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"r-lib/usethis"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"r-lib/usethis"</span><span class="op">)</span></span></code></pre></div>
<p>Lifecycle-wise, remotes is being replaced by pak, but we are still in
the transition period, where both are maintained.</p>
<p>Both of these packages potentially need a GitHub PAT. A PAT is
necessary, for example, to install from a private GitHub repo. Even when
accessing public resources, a PAT is helpful because it implies a much
higher rate limit for requests to the GitHub API.</p>
<p>pak uses the same PAT-finding approach as usethis/gh/gitcreds. Once
you’ve done the setup described above, pak should “just work”, with the
same PAT as everything else.</p>
<p>remotes does NOT use the new PAT-finding approach and, instead, only
consults the <code>GITHUB_PAT</code> environment variable, falling back
to a built-in generic credential.</p>
<p>What should you do re: installing packages from GitHub?</p>
<p>My personal recommendation: Use
<code>pak::pkg_install("OWNER/REPO")</code> for your explicit “install
from GitHub” needs. Allow remotes to use its fallback credential, if it
ever gets called implicitly. Do NOT define <code>GITHUB_PAT</code> in
<code>.Renviron</code>.</p>
<p>If you want to keep using remotes, instead of pak, you could just
rely on the built-in credential. This will suffice if rate-limiting is
the only concern, but obviously will not provide access to private
repositories.</p>
<p>If you really want to use remotes, with your own PAT, you can
“tickle” gitcreds, via <code><a href="https://gitcreds.r-lib.org/reference/gitcreds_get.html" class="external-link">gitcreds::gitcreds_get()</a></code>, to get it
to load your PAT from the store into the <code>GITHUB_PAT</code>
environment variable, where remotes will happily find it. This could be
done interactively as needed, written into individual scripts, or even
executed in a startup file. This still avoids defining
<code>GITHUB_PAT</code> in <code>.Renviron</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>GITHUB_PAT <span class="op">=</span> <span class="fu">gitcreds</span><span class="fu">::</span><span class="fu"><a href="https://gitcreds.r-lib.org/reference/gitcreds_get.html" class="external-link">gitcreds_get</a></span><span class="op">(</span>use_cache <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">password</span><span class="op">)</span></span></code></pre></div>
<p>If you use remotes, make sure to update to the latest version, to
guarantee that the built-in credential is valid.</p>
</div>
<div class="section level3">
<h3 id="continuous-integration">Continuous integration<a class="anchor" aria-label="anchor" href="#continuous-integration"></a>
</h3>
<p>On a headless system, such as on a CI/CD platform like GitHub
Actions, you won’t be able to interactively store a PAT with
<code><a href="https://gitcreds.r-lib.org/reference/gitcreds_get.html" class="external-link">gitcreds::gitcreds_set()</a></code> or
<code><a href="https://docs.ropensci.org/credentials/reference/set_github_pat.html" class="external-link">credentials::set_github_pat()</a></code>. In the case of GitHub
Actions, an access token is automatically available to the workflow and
can be exposed to R as the <code>GITHUB_PAT</code> environment variable
like so:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="at">  </span><span class="fu">GITHUB_PAT</span><span class="kw">:</span><span class="at"> ${{ secrets.GITHUB_TOKEN }}</span></span></code></pre></div>
<p>If this automatic token doesn’t have sufficient permissions, you’ll
need to create a suitable token and store it as a repository secret.</p>
<p>This is also the general approach for CI/CD platforms other than
GitHub Actions:</p>
<ul>
<li>Provide the PAT as a secure <code>GITHUB_PAT</code> environment
variable.</li>
<li>Use regular environment variables to store less sensitive settings,
such as the API host.</li>
</ul>
<p>Take care not to expose your PAT by, e.g., printing environment
variables to a log file.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-to-learn-more">How to learn more<a class="anchor" aria-label="anchor" href="#how-to-learn-more"></a>
</h2>
<p>gh and gitcreds</p>
<ul>
<li>gh: <a href="https://gh.r-lib.org/" class="external-link">gh.r-lib.org</a>
</li>
<li>gh vignette: <a href="https://gh.r-lib.org/articles/managing-personal-access-tokens.html" class="external-link">Managing
Personal Access Tokens</a>
</li>
<li>gitcreds: <a href="https://r-lib.github.io/gitcreds/" class="external-link">r-lib.github.io/gitcreds/</a>
</li>
</ul>
<p>gert and credentials</p>
<ul>
<li>gert: <a href="https://docs.ropensci.org/gert/" class="external-link">docs.ropensci.org/gert</a>
</li>
<li>credentials: <a href="https://docs.ropensci.org/credentials/" class="external-link">docs.ropensci.org/credentials</a>
</li>
<li>rOpenSci tech note: <a href="https://ropensci.org/technotes/2020/07/07/github-pat/" class="external-link">A better
way to manage your GitHub personal access tokens</a>
</li>
</ul>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, Malcolm Barrett, Andy Teucher, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
